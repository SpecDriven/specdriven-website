---
// How It Works 3-step process section (Assess → Pilot → Scale)
---

<section id="how-it-works" class="section-padding bg-gradient-to-br from-cream to-white relative overflow-hidden">
  <!-- Background geometric pattern -->
  <div class="absolute inset-0 pattern-dots opacity-20"></div>

  <div class="max-w-7xl mx-auto container-padding relative">
    <!-- Section Header -->
    <div class="text-center mb-20">
      <h2 class="text-h1 font-heading font-bold text-charcoal mb-6">
        How We Transform Your Development Process
      </h2>
      <p class="text-xl text-gray-600 max-w-3xl mx-auto text-balance">
        Our proven 3-step methodology ensures smooth adoption of spec-driven development with measurable results at each stage.
      </p>
    </div>

    <!-- Process Steps -->
    <div class="relative">
      <!-- Connection Line -->
      <div class="hidden lg:block absolute top-1/2 left-0 right-0 h-px bg-gradient-primary transform -translate-y-1/2"></div>

      <div class="grid lg:grid-cols-3 gap-8 lg:gap-12">
        <!-- Step 1: Assess -->
        <div class="relative">
          <div class="service-card glass p-8 relative z-10 border-2 border-emerald-200">
            <!-- Step Number -->
            <div class="w-16 h-16 bg-gradient-emerald rounded-xl flex items-center justify-center mx-auto mb-6 relative shadow-lg">
              <span class="text-2xl font-bold text-white">1</span>
              <div class="absolute -top-2 -right-2 w-6 h-6 bg-emerald-600 rounded-full flex items-center justify-center">
                <svg class="w-3 h-3 text-white" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M9 12L11 14L15 10M21 12C21 16.97 16.97 21 12 21C7.03 21 3 16.97 3 12C3 7.03 7.03 3 12 3C16.97 3 21 7.03 21 12Z"/>
                </svg>
              </div>
            </div>

            <h3 class="text-2xl font-heading font-bold text-charcoal text-center mb-4">
              Assess & Analyze
            </h3>

            <p class="text-gray-600 text-center mb-6">
              Comprehensive evaluation of your current processes, tools, and team capabilities to identify transformation opportunities.
            </p>

            <!-- Key Activities -->
            <div class="space-y-3">
              <div class="flex items-start space-x-3">
                <div class="w-5 h-5 bg-emerald-100 rounded-full flex items-center justify-center mt-0.5">
                  <svg class="w-3 h-3 text-emerald-600" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M9 12L11 14L15 10M21 12C21 16.97 16.97 21 12 21C7.03 21 3 16.97 3 12C3 7.03 7.03 3 12 3C16.97 3 21 7.03 21 12Z"/>
                  </svg>
                </div>
                <span class="text-sm text-gray-600">Process maturity assessment</span>
              </div>
              <div class="flex items-start space-x-3">
                <div class="w-5 h-5 bg-emerald-100 rounded-full flex items-center justify-center mt-0.5">
                  <svg class="w-3 h-3 text-emerald-600" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M9 12L11 14L15 10M21 12C21 16.97 16.97 21 12 21C7.03 21 3 16.97 3 12C3 7.03 7.03 3 12 3C16.97 3 21 7.03 21 12Z"/>
                  </svg>
                </div>
                <span class="text-sm text-gray-600">Tool integration analysis</span>
              </div>
              <div class="flex items-start space-x-3">
                <div class="w-5 h-5 bg-emerald-100 rounded-full flex items-center justify-center mt-0.5">
                  <svg class="w-3 h-3 text-emerald-600" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M9 12L11 14L15 10M21 12C21 16.97 16.97 21 12 21C7.03 21 3 16.97 3 12C3 7.03 7.03 3 12 3C16.97 3 21 7.03 21 12Z"/>
                  </svg>
                </div>
                <span class="text-sm text-gray-600">Team capability mapping</span>
              </div>
              <div class="flex items-start space-x-3">
                <div class="w-5 h-5 bg-emerald-100 rounded-full flex items-center justify-center mt-0.5">
                  <svg class="w-3 h-3 text-emerald-600" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M9 12L11 14L15 10M21 12C21 16.97 16.97 21 12 21C7.03 21 3 16.97 3 12C3 7.03 7.03 3 12 3C16.97 3 21 7.03 21 12Z"/>
                  </svg>
                </div>
                <span class="text-sm text-gray-600">ROI roadmap creation</span>
              </div>
            </div>

            <!-- Duration & Outcome -->
            <div class="mt-6 pt-6 border-t border-gray-200">
              <div class="flex justify-between items-center text-sm">
                <span class="text-gray-500">Duration:</span>
                <span class="font-medium text-gray-900">1-2 weeks</span>
              </div>
              <div class="flex justify-between items-center text-sm mt-2">
                <span class="text-gray-500">Outcome:</span>
                <span class="font-medium text-gray-900">Strategic roadmap</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Step 2: Pilot -->
        <div class="relative">
          <div class="service-card glass p-8 relative z-10 border-2 border-indigo-200">
            <!-- Step Number -->
            <div class="w-16 h-16 bg-gradient-primary rounded-xl flex items-center justify-center mx-auto mb-6 relative shadow-lg">
              <span class="text-2xl font-bold text-white">2</span>
              <div class="absolute -top-2 -right-2 w-6 h-6 bg-indigo-600 rounded-full flex items-center justify-center">
                <svg class="w-3 h-3 text-white" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M13 10V3L4 14H11V21L20 10H13Z"/>
                </svg>
              </div>
            </div>

            <h3 class="text-2xl font-heading font-bold text-charcoal text-center mb-4">
              Implement & Prove
            </h3>

            <p class="text-gray-600 text-center mb-6">
              Implement spec-driven development with a focused pilot project to demonstrate value and refine the approach.
            </p>

            <!-- Key Activities -->
            <div class="space-y-3">
              <div class="flex items-start space-x-3">
                <div class="w-5 h-5 bg-indigo-100 rounded-full flex items-center justify-center mt-0.5">
                  <svg class="w-3 h-3 text-indigo-600" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M9 12L11 14L15 10M21 12C21 16.97 16.97 21 12 21C7.03 21 3 16.97 3 12C3 7.03 7.03 3 12 3C16.97 3 21 7.03 21 12Z"/>
                  </svg>
                </div>
                <span class="text-sm text-gray-600">BDD framework setup</span>
              </div>
              <div class="flex items-start space-x-3">
                <div class="w-5 h-5 bg-indigo-100 rounded-full flex items-center justify-center mt-0.5">
                  <svg class="w-3 h-3 text-indigo-600" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M9 12L11 14L15 10M21 12C21 16.97 16.97 21 12 21C7.03 21 3 16.97 3 12C3 7.03 7.03 3 12 3C16.97 3 21 7.03 21 12Z"/>
                  </svg>
                </div>
                <span class="text-sm text-gray-600">AI agent configuration</span>
              </div>
              <div class="flex items-start space-x-3">
                <div class="w-5 h-5 bg-indigo-100 rounded-full flex items-center justify-center mt-0.5">
                  <svg class="w-3 h-3 text-indigo-600" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M9 12L11 14L15 10M21 12C21 16.97 16.97 21 12 21C7.03 21 3 16.97 3 12C3 7.03 7.03 3 12 3C16.97 3 21 7.03 21 12Z"/>
                  </svg>
                </div>
                <span class="text-sm text-gray-600">Team training & onboarding</span>
              </div>
              <div class="flex items-start space-x-3">
                <div class="w-5 h-5 bg-indigo-100 rounded-full flex items-center justify-center mt-0.5">
                  <svg class="w-3 h-3 text-indigo-600" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M9 12L11 14L15 10M21 12C21 16.97 16.97 21 12 21C7.03 21 3 16.97 3 12C3 7.03 7.03 3 12 3C16.97 3 21 7.03 21 12Z"/>
                  </svg>
                </div>
                <span class="text-sm text-gray-600">Pilot project execution</span>
              </div>
            </div>

            <!-- Duration & Outcome -->
            <div class="mt-6 pt-6 border-t border-gray-200">
              <div class="flex justify-between items-center text-sm">
                <span class="text-gray-500">Duration:</span>
                <span class="font-medium text-gray-900">4-6 weeks</span>
              </div>
              <div class="flex justify-between items-center text-sm mt-2">
                <span class="text-gray-500">Outcome:</span>
                <span class="font-medium text-gray-900">Proven value</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Step 3: Scale -->
        <div class="relative">
          <div class="service-card glass p-8 relative z-10 border-2 border-amber-200">
            <!-- Step Number -->
            <div class="w-16 h-16 bg-gradient-amber rounded-xl flex items-center justify-center mx-auto mb-6 relative shadow-lg">
              <span class="text-2xl font-bold text-white">3</span>
              <div class="absolute -top-2 -right-2 w-6 h-6 bg-amber-600 rounded-full flex items-center justify-center">
                <svg class="w-3 h-3 text-white" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M16 6L18.29 8.29L13.41 13.17L9.41 9.17L2 16.59L3.41 18L9.41 12L13.41 16L19.71 9.71L22 12V6H16Z"/>
                </svg>
              </div>
            </div>

            <h3 class="text-2xl font-heading font-bold text-charcoal text-center mb-4">
              Scale & Optimize
            </h3>

            <p class="text-gray-600 text-center mb-6">
              Expand successful practices across your organization while continuously optimizing for better outcomes.
            </p>

            <!-- Key Activities -->
            <div class="space-y-3">
              <div class="flex items-start space-x-3">
                <div class="w-5 h-5 bg-green-100 rounded-full flex items-center justify-center mt-0.5">
                  <svg class="w-3 h-3 text-green-600" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M9 12L11 14L15 10M21 12C21 16.97 16.97 21 12 21C7.03 21 3 16.97 3 12C3 7.03 7.03 3 12 3C16.97 3 21 7.03 21 12Z"/>
                  </svg>
                </div>
                <span class="text-sm text-gray-600">Multi-team rollout</span>
              </div>
              <div class="flex items-start space-x-3">
                <div class="w-5 h-5 bg-green-100 rounded-full flex items-center justify-center mt-0.5">
                  <svg class="w-3 h-3 text-green-600" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M9 12L11 14L15 10M21 12C21 16.97 16.97 21 12 21C7.03 21 3 16.97 3 12C3 7.03 7.03 3 12 3C16.97 3 21 7.03 21 12Z"/>
                  </svg>
                </div>
                <span class="text-sm text-gray-600">Process standardization</span>
              </div>
              <div class="flex items-start space-x-3">
                <div class="w-5 h-5 bg-green-100 rounded-full flex items-center justify-center mt-0.5">
                  <svg class="w-3 h-3 text-green-600" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M9 12L11 14L15 10M21 12C21 16.97 16.97 21 12 21C7.03 21 3 16.97 3 12C3 7.03 7.03 3 12 3C16.97 3 21 7.03 21 12Z"/>
                  </svg>
                </div>
                <span class="text-sm text-gray-600">Performance optimization</span>
              </div>
              <div class="flex items-start space-x-3">
                <div class="w-5 h-5 bg-green-100 rounded-full flex items-center justify-center mt-0.5">
                  <svg class="w-3 h-3 text-green-600" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M9 12L11 14L15 10M21 12C21 16.97 16.97 21 12 21C7.03 21 3 16.97 3 12C3 7.03 7.03 3 12 3C16.97 3 21 7.03 21 12Z"/>
                  </svg>
                </div>
                <span class="text-sm text-gray-600">Continuous improvement</span>
              </div>
            </div>

            <!-- Duration & Outcome -->
            <div class="mt-6 pt-6 border-t border-gray-200">
              <div class="flex justify-between items-center text-sm">
                <span class="text-gray-500">Duration:</span>
                <span class="font-medium text-gray-900">3-6 months</span>
              </div>
              <div class="flex justify-between items-center text-sm mt-2">
                <span class="text-gray-500">Outcome:</span>
                <span class="font-medium text-gray-900">Scaled success</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Results Section -->
    <div class="mt-20">
      <div class="glass rounded-2xl p-8 lg:p-12 bg-gradient-primary text-white border-2 border-indigo-200 relative overflow-hidden">
        <!-- Background decoration -->
        <div class="absolute inset-0 bg-gradient-mesh opacity-30"></div>
        <div class="relative">
          <div class="text-center mb-8">
            <h3 class="text-2xl lg:text-3xl font-heading font-bold mb-4">
              Typical Results After 6 Months
            </h3>
            <p class="text-indigo-100 text-lg max-w-2xl mx-auto text-balance">
              Organizations following our methodology see consistent improvements across key delivery metrics.
            </p>
          </div>

          <div class="grid sm:grid-cols-2 lg:grid-cols-4 gap-6">
            <div class="text-center">
              <div class="text-3xl lg:text-4xl font-bold mb-2">40%</div>
              <div class="text-indigo-100">Faster delivery</div>
            </div>
            <div class="text-center">
              <div class="text-3xl lg:text-4xl font-bold mb-2">60%</div>
              <div class="text-indigo-100">Fewer defects</div>
            </div>
            <div class="text-center">
              <div class="text-3xl lg:text-4xl font-bold mb-2">50%</div>
              <div class="text-indigo-100">Less rework</div>
            </div>
            <div class="text-center">
              <div class="text-3xl lg:text-4xl font-bold mb-2">80%</div>
              <div class="text-indigo-100">Team alignment</div>
            </div>
          </div>

          <div class="text-center mt-8">
            <button
              class="bg-white text-indigo-600 px-8 py-4 rounded-lg font-semibold text-lg hover:bg-indigo-50 transition-all duration-300 shadow-lg hover:shadow-xl hover:-translate-y-0.5"
              data-calendly-source="how-it-works-cta"
            >
              Start Your Transformation
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<script>
  import { handleCalendlyClick, preloadCalendlyScript } from '../../lib/calendly';

  // Handle how-it-works CTA click
  const howItWorksCtaButton = document.querySelector('[data-calendly-source="how-it-works-cta"]');
  if (howItWorksCtaButton) {
    // Preload script on hover/focus
    howItWorksCtaButton.addEventListener('mouseenter', preloadCalendlyScript);
    howItWorksCtaButton.addEventListener('focus', preloadCalendlyScript);

    // Handle click
    howItWorksCtaButton.addEventListener('click', (e) => {
      e.preventDefault();
      handleCalendlyClick('how-it-works-cta');
    });
  }

  // Add intersection observer for step animations
  if (typeof window !== 'undefined') {
    const observer = new IntersectionObserver(
      (entries) => {
        entries.forEach((entry) => {
          if (entry.isIntersecting) {
            entry.target.style.animationDelay = `${entry.target.dataset.delay || 0}ms`;
            entry.target.classList.add('animate-slide-up');
          }
        });
      },
      { threshold: 0.2 }
    );

    // Observe step cards with staggered animation
    document.querySelectorAll('.relative > .bg-white').forEach((card, index) => {
      card.dataset.delay = (index * 200).toString();
      observer.observe(card);
    });
  }
</script>